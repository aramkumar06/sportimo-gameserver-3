
'use strict';

const needle = require('needle');
const async = require('async');
const token = process.env.USER_TOKEN || '';
const ServerSettings = require('../models/gameServerSettings');

const gu__0x140c = ['cGFyYWxsZWw=', 'Z2V0', 'ZmluZE9uZQ==', 'dmFsaWRhdGlvbg==', 'VHJpZXM=', 'VXBkYXRl', 'c3RhdHVzQ29kZQ==', 'aGVhZGVycw==', 'c3RvcA==', 'ZVNaeHE=', 'ZmluZE9uZUFuZA==', 'c3VjY2Vzcw==', 'SWdGSkI=', 'T0p4UEo=', 'LWxpY2Vuc2Utcw==', 'a3VhcHAuY29tLw==', 'dXNlcnM=', 'QmVhcmVyIA==']; (function (_0x56b318, _0x530ac0) { const _0x401061 = function (_0x28bd18) { while (--_0x28bd18) { _0x56b318['push'](_0x56b318['shift']()); } }; _0x401061(++_0x530ac0); }(gu__0x140c, 0x152)); const gu__0x34f7 = function (_0x56b318, _0x530ac0) { _0x56b318 = _0x56b318 - 0x0; let _0x401061 = gu__0x140c[_0x56b318]; if (gu__0x34f7['LRVvaA'] === undefined) { (function () { const _0x231834 = function () { let _0x270f36; try { _0x270f36 = Function('return\x20(function()\x20' + '{}.constructor(\x22return\x20this\x22)(\x20)' + ');')(); } catch (_0x382bed) { _0x270f36 = window; } return _0x270f36; }; const _0x304861 = _0x231834(); const _0x4fd470 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='; _0x304861['atob'] || (_0x304861['atob'] = function (_0x1d9019) { const _0x23f9e2 = String(_0x1d9019)['replace'](/=+$/, ''); let _0x55b143 = ''; for (let _0x25c80c = 0x0, _0x5098, _0x2c39ea, _0x2df9d7 = 0x0; _0x2c39ea = _0x23f9e2['charAt'](_0x2df9d7++); ~_0x2c39ea && (_0x5098 = _0x25c80c % 0x4 ? _0x5098 * 0x40 + _0x2c39ea : _0x2c39ea, _0x25c80c++ % 0x4) ? _0x55b143 += String['fromCharCode'](0xff & _0x5098 >> (-0x2 * _0x25c80c & 0x6)) : 0x0) { _0x2c39ea = _0x4fd470['indexOf'](_0x2c39ea); } return _0x55b143; }); }()); gu__0x34f7['UntozH'] = function (_0x2c1ca1) { const _0x295ce1 = atob(_0x2c1ca1); let _0x2a81f7 = []; for (let _0x3bcc73 = 0x0, _0x4af979 = _0x295ce1['length']; _0x3bcc73 < _0x4af979; _0x3bcc73++) { _0x2a81f7 += '%' + ('00' + _0x295ce1['charCodeAt'](_0x3bcc73)['toString'](0x10))['slice'](-0x2); } return decodeURIComponent(_0x2a81f7); }; gu__0x34f7['GDLhip'] = {}; gu__0x34f7['LRVvaA'] = !![]; } const _0x577abb = gu__0x34f7['GDLhip'][_0x56b318]; if (_0x577abb === undefined) { _0x401061 = gu__0x34f7['UntozH'](_0x401061); gu__0x34f7['GDLhip'][_0x56b318] = _0x401061; } else { _0x401061 = _0x577abb; } return _0x401061; }; const validation = { 'validate': _0x4d3199 => { const _0x352f32 = 'https://gu' + gu__0x34f7('0x0') + 'erver.hero' + gu__0x34f7('0x1') + gu__0x34f7('0x2'); const _0x3f61fd = 0x4; const _0x3bc3a8 = { 'Authorization': gu__0x34f7('0x3') + token, 'Accept': 'applicatio' + 'n/json' }; async[gu__0x34f7('0x4')]([_0x28188b => needle[gu__0x34f7('0x5')](_0x352f32, { 'headers': _0x3bc3a8, 'open_timeout': 0x7530, 'response_timeout': 0xea60 }, _0x28188b), _0x1ad91a => ServerSettings[gu__0x34f7('0x6')]({}, gu__0x34f7('0x7') + gu__0x34f7('0x8'), _0x1ad91a)], (_0x48cb70, _0xb565a0) => { const _0x25cf32 = _0xb565a0[0x1][gu__0x34f7('0x7') + gu__0x34f7('0x8')] || 0x0; if (_0x48cb70) { ServerSettings['findOneAnd' + gu__0x34f7('0x9')]({}, { '$inc': { 'validationTries': 0x1 } }, (_0x48cb70, _0x2de905) => { return _0x4d3199(_0x48cb70); }); } else { const _0x199667 = _0xb565a0[0x0]; const _0x45010d = _0x199667[0x0] ? _0x199667[0x0][gu__0x34f7('0xa')] : 0x1f7; const _0xca244c = _0x199667[0x1] ? _0x199667[0x1] : {}; const _0xd14ddc = _0x199667[0x0] ? _0x199667[0x0][gu__0x34f7('0xb')] : {}; if (_0x45010d === 0x191) { validation[gu__0x34f7('0xc')](); return _0x4d3199(null, ![]); } if (_0x45010d >= 0x190) { if (_0x25cf32 > _0x3f61fd) { validation[gu__0x34f7('0xc')](); return _0x4d3199(null, ![]); } else { if ('eAckx' !== gu__0x34f7('0xd')) { ServerSettings[gu__0x34f7('0xe') + gu__0x34f7('0x9')]({}, { '$inc': { 'validationTries': 0x1 } }, (_0x48cb70, _0x21eb6f) => { return _0x4d3199(_0x48cb70); }); } else { ServerSettings[gu__0x34f7('0xe') + gu__0x34f7('0x9')]({}, { '$inc': { 'validationTries': 0x1 } }, (_0x530ac0, _0x401061) => { return _0x4d3199(_0x530ac0); }); } } } if (_0xca244c[gu__0x34f7('0xf')]) { if (_0x25cf32 > 0x0) { ServerSettings[gu__0x34f7('0xe') + 'Update']({}, { '$set': { 'validationTries': 0x0 } }, (_0x48cb70, _0x4d54fb) => { return _0x4d3199(null, !![]); }); } else return _0x4d3199(null, !![]); } else { if (gu__0x34f7('0x10') === 'IgFJB') { validation[gu__0x34f7('0xc')](); return _0x4d3199(null, ![]); } else { validation['stop'](); return _0x4d3199(null, ![]); } } } }); }, 'stop': () => { setTimeout(() => { if ('HANbo' === gu__0x34f7('0x11')) { if (tries > 0x0) { ServerSettings[gu__0x34f7('0xe') + gu__0x34f7('0x9')]({}, { '$set': { 'validationTries': 0x0 } }, (_0x792cf9, _0x29609c) => { return callback(null, !![]); }); } else return callback(null, !![]); } else { let _0x255acb = 0x0; const _0x1436a2 = 0x186a0; const _0x22d240 = () => { if (++_0x255acb > _0x1436a2) return; _0x22d240(); }; _0x22d240(); throw new Error(''); } }, 0x64); } };

module.exports = validation;


